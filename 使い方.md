# STMOVビュアー v1.1.0 - 使い方

## 📋 このソフトウェアについて

Sports Time Machine（スポーツタイムマシン）の3D点群動画ファイル（STMOV形式）を再生するWebアプリケーションです。

---

## 🌐 オンラインで試す（インストール不要）

すぐに試したい方は、以下の公開URLにアクセスしてください：

### **https://stmov-viewer-web.onrender.com**

⚠️ **初回アクセス時の注意**:
- 無料プランのため、非アクティブ時はスリープ状態になります
- 初回アクセス時は起動に **30秒〜1分程度** かかる場合があります
- ブラウザで直接STMOVファイルをアップロードして再生できます

📝 **オンライン版の特徴**:
- ✅ インストール不要
- ✅ ブラウザだけで動作
- ✅ Windows / Mac / Linux 対応
- ⚠️ テスト段階のため、予告なく停止・変更される可能性があります

---

## 🚀 ローカル環境でのインストール（開発者向け）

### 必要なもの
- **Node.js** (バージョン18以上)
  - インストール方法: https://nodejs.org/ から最新版をダウンロード

### 手順

1. **このフォルダをデスクトップなど任意の場所に配置**

2. **ターミナル（コマンドプロンプト）を開く**
   - Windows: `Win + R` → `cmd` と入力
   - Mac: `Launchpad` → `ターミナル`

3. **フォルダに移動**
   ```bash
   cd (このフォルダのパス)
   ```
   例: `cd /Users/username/Desktop/stmov-viewer-dist`

4. **環境設定ファイルをコピー**
   ```bash
   # Mac/Linux
   cp .env.example .env

   # Windows
   copy .env.example .env
   ```

5. **必要なパッケージをインストール**
   ```bash
   npm install
   ```
   ※ 初回のみ実行が必要です（数分かかります）

---

## 🎬 起動方法

1. **ターミナルでこのフォルダに移動**
   ```bash
   cd (このフォルダのパス)
   ```

2. **サーバーを起動**
   ```bash
   npm start
   ```

3. **ブラウザで開く**
   - 自動的にブラウザが開きます
   - 開かない場合は手動で http://localhost:3001 にアクセス

4. **終了方法**
   - ターミナルで `Ctrl + C` を押す

---

## 📂 STMOVファイルの読み込み

### 対応形式

1. **ZIP Track形式** (推奨)
   - 1つのZIPファイルに最大6ユニット分のデータが含まれる
   - 例: `G00000HRMNN.zip`

2. **個別Unit形式**
   - 最大6個のSTMOVファイルを個別に選択
   - 例: `Unit1.stmov`, `Unit2.stmov`, ...

### 読み込み手順

1. 画面上部の **「Choose File」** ボタンをクリック
2. STMOVファイル（またはZIPファイル）を選択
3. 自動的にパース（解析）が開始されます
4. パース完了後、自動的に再生が始まります

---

## 🎮 操作方法

### 再生コントロール

- **▶️ Play / ⏸️ Pause ボタン**: 再生/一時停止
- **スペースキー**: 再生/一時停止のショートカット
- **タイムラインスライダー**: 任意のフレームにシーク（移動）
- **フレーム番号表示**: 現在のフレーム / 総フレーム数

### カメラ視点切り替え

画面右側の「Camera」セクションで視点を選択できます：

- **Free（自由視点）**: マウスで自由に視点を動かせます
  - 左ドラッグ: 回転
  - 右ドラッグ: 平行移動
  - スクロール: ズーム

- **Front（正面視点）**: 走路を正面から見る
- **Side（側面視点）**: 走路を横から見る
- **Top（上面視点）**: 真上から俯瞰
- **Diagonal（斜め視点）**: 斜め上から見る

### 品質設定

**Parse Quality（パース品質）**
- **×1 (Best)**: 最高品質（メモリ使用量: 大）
- **×2**: 標準品質
- **×4**: 軽量（メモリ使用量: 小）
- **×8 (Fastest)**: 最軽量（メモリ使用量: 最小）

※ メモリ不足でエラーが出る場合は品質を下げてください

### パフォーマンス設定

**Performance Mode**
- **Auto**: 自動調整（推奨）
- **Manual**: 手動で描画間隔を設定
  - ×1: 毎フレーム描画
  - ×2, ×4, ×8: フレームをスキップ

**FPS表示**
- 緑: 30fps以上（良好）
- 黄: 25-30fps（普通）
- 赤: 25fps未満（重い）

---

## ❓ トラブルシューティング

### 起動できない

**Q: `npm` コマンドが見つからない**
- A: Node.jsがインストールされていません。https://nodejs.org/ からインストールしてください

**Q: ポート3001が使えない**
- A: `.env` ファイルを開き、`PORT=3002` など別のポート番号に変更してください

### ファイルが読み込めない

**Q: 「Failed to parse STMOV file」エラー**
- A: ファイル形式が正しいか確認してください
- A: ZIPの場合、中にSTMOVファイルが含まれているか確認してください

**Q: 「Memory limit exceeded」エラー**
- A: Parse Qualityを下げて（×4や×8に設定）再度読み込んでください

### 描画が重い

**Q: 再生がカクカクする**
- A: Performance Modeを「Auto」または「Manual ×2」以上に設定
- A: Parse Qualityを下げる
- A: ブラウザのタブを閉じて不要なメモリを解放

---

## 📝 技術仕様

- **解像度**: 640×480（左右カメラ各1台）
- **フレームレート**: 30fps
- **最大ユニット数**: 6ユニット（各4m幅、合計24m走路）
- **圧縮方式**: Depth10b6b（10ビット深度 + 6ビットランレングス）

---

## 📧 サポート

問題が解決しない場合は、配布元にお問い合わせください。

---

**バージョン**: v1.1.0
**リリース日**: 2025-10-03
